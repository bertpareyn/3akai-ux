casper.test.comment('Widget - Product video');

/**
 * Verify opening the product video modal with assertions
 */
var verifyOpenProductModal = function() {
    casper.waitForSelector('.oae-trigger-productvideo', function() {
        casper.test.assertExists('.oae-trigger-productvideo', 'Product video trigger exists');

        // TODO: We need a way to hook into a "page setup" event
        casper.wait(3000, function() {
            casper.click('.oae-trigger-productvideo');
            casper.waitForSelector('#productvideo-modal iframe', function() {
                casper.test.assertExists('#productvideo-modal iframe', 'Product video pane is showing after trigger');
            });
        });
    });
};

casper.start('http://test.oae.com', function() {
    casper.then(function() {
        casper.echo('Verify product video modal', 'INFO');
        verifyOpenProductModal();
    });
});

casper.run(function() {
    this.test.done();
});
